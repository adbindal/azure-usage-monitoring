(function() { var fnCallback =  arguments.callee; var hrefs=[]; var resultObj = $("<div id=\"resultObj\"></div>").appendTo("body").hide(); resultText = ""; var leaveObj = $("<div id=\"leaveObj\"></div>").appendTo("body").hide(); var loadHrefCount=0; $(".subscription-item").each(function(e) { var subscriptionName = $(this).find(".name").text(); var href=$(this).attr("href"); var statusVal=$(this).find(".status").text(); hrefs.push(href); if (statusVal!="Active" || includeList==null || (subscriptionName in includeList)) { loadHrefCount++; return; } $.get(href, "", function(data) { var subscriptionId = $(data).find("#subscription-guid").text(); var amount = $(data).find(".subscription-estimated-cost").text(); var friendlyName = $(data).find(".subscription-friendly-name").text(); var orderid = $(data).find("#subscription-friendly-id").text(); var serviceAdminEmail = $(data).find("#service-administrator-email").text(); var accountAdminEmail = $(data).find("#account-administrator-email").text(); var subscriptionStatus = $(data).find("#subscription-status").text(); var effectiveRange = $(data).find("#subscription-effective-range").text(); var editSubscriptionHref = $(data).find("#edit-subscription-details").attr("href"); resultText += subscriptionId + "," + friendlyName + "," + amount + "," + orderid + "," + serviceAdminEmail + "," + accountAdminEmail + "," + subscriptionStatus + "," + effectiveRange + "," + editSubscriptionHref + "\r\n<br/>"; loadHrefCount++; if (loadHrefCount==hrefs.length) { resultObj.html(resultText); } leaveObj.text(hrefs.length - loadHrefCount); } ); }); })();